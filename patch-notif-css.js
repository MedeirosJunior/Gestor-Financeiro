const fs = require('fs');
let c = fs.readFileSync('gestor-financeiro-frontend/src/App.css', 'utf8');
const R = '\r\n';

const notifCSS = [
    `/* ═══ NOTIFICAÇÕES ═══ */`,
    ``,
    `/* Sino no header */`,
    `.notif-bell-wrap {`,
    `  position: relative;`,
    `  display: inline-flex;`,
    `  align-items: center;`,
    `}`,
    `.notif-bell-btn {`,
    `  background: rgba(255,255,255,0.1);`,
    `  border: 1px solid rgba(255,255,255,0.2);`,
    `  border-radius: 8px;`,
    `  padding: 5px 10px;`,
    `  cursor: pointer;`,
    `  font-size: 1.1rem;`,
    `  transition: background 0.2s;`,
    `  position: relative;`,
    `}`,
    `.notif-bell-btn:hover { background: rgba(255,255,255,0.2); }`,
    `.notif-badge {`,
    `  position: absolute;`,
    `  top: -4px;`,
    `  right: -4px;`,
    `  background: #e74c3c;`,
    `  color: #fff;`,
    `  font-size: 0.65rem;`,
    `  font-weight: 700;`,
    `  min-width: 17px;`,
    `  height: 17px;`,
    `  border-radius: 9px;`,
    `  display: flex;`,
    `  align-items: center;`,
    `  justify-content: center;`,
    `  padding: 0 3px;`,
    `  line-height: 1;`,
    `}`,
    ``,
    `/* Overlay + Painel */`,
    `.notif-overlay {`,
    `  position: fixed;`,
    `  inset: 0;`,
    `  z-index: 1200;`,
    `  background: transparent;`,
    `}`,
    `.notif-panel {`,
    `  position: fixed;`,
    `  top: 70px;`,
    `  right: 16px;`,
    `  width: 370px;`,
    `  max-width: calc(100vw - 32px);`,
    `  max-height: 560px;`,
    `  background: #fff;`,
    `  border-radius: 14px;`,
    `  box-shadow: 0 12px 40px rgba(0,0,0,0.18);`,
    `  display: flex;`,
    `  flex-direction: column;`,
    `  z-index: 1201;`,
    `  overflow: hidden;`,
    `}`,
    `.notif-panel-header {`,
    `  display: flex;`,
    `  align-items: center;`,
    `  justify-content: space-between;`,
    `  padding: 14px 16px 10px;`,
    `  border-bottom: 1px solid #f1f5f9;`,
    `  font-weight: 600;`,
    `  font-size: 0.95rem;`,
    `  color: #1e293b;`,
    `}`,
    `.notif-mark-read {`,
    `  background: none;`,
    `  border: 1px solid #22c55e;`,
    `  color: #22c55e;`,
    `  border-radius: 6px;`,
    `  padding: 3px 8px;`,
    `  font-size: 0.75rem;`,
    `  cursor: pointer;`,
    `  transition: background 0.15s;`,
    `}`,
    `.notif-mark-read:hover { background: #f0fdf4; }`,
    `.notif-close-btn {`,
    `  background: none;`,
    `  border: none;`,
    `  font-size: 1rem;`,
    `  cursor: pointer;`,
    `  color: #94a3b8;`,
    `  padding: 2px 6px;`,
    `  border-radius: 4px;`,
    `}`,
    `.notif-close-btn:hover { background: #f1f5f9; }`,
    `.notif-list {`,
    `  flex: 1;`,
    `  overflow-y: auto;`,
    `  padding: 8px 0;`,
    `}`,
    `.notif-item {`,
    `  display: flex;`,
    `  gap: 12px;`,
    `  align-items: flex-start;`,
    `  padding: 10px 16px;`,
    `  border-bottom: 1px solid #f8fafc;`,
    `  transition: background 0.1s;`,
    `}`,
    `.notif-item:hover { background: #f8fafc; }`,
    `.notif-item.unread { background: #eff6ff; }`,
    `.notif-item.unread:hover { background: #dbeafe; }`,
    `.notif-item-icon { font-size: 1.3rem; line-height: 1; flex-shrink: 0; margin-top: 1px; }`,
    `.notif-item-content { flex: 1; min-width: 0; }`,
    `.notif-item-title { font-weight: 600; font-size: 0.88rem; color: #1e293b; margin-bottom: 2px; }`,
    `.notif-item-body { font-size: 0.82rem; color: #475569; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }`,
    `.notif-item-date { font-size: 0.75rem; color: #94a3b8; margin-top: 3px; }`,
    `/* Type color bar */`,
    `.notif-type-overdue .notif-item-title,`,
    `.notif-type-over-budget .notif-item-title,`,
    `.notif-type-goal-overdue .notif-item-title { color: #e74c3c; }`,
    `.notif-type-goal-achieved .notif-item-title { color: #16a34a; }`,
    `.notif-empty {`,
    `  padding: 40px 16px;`,
    `  text-align: center;`,
    `  color: #94a3b8;`,
    `  font-size: 0.9rem;`,
    `}`,
    `.notif-panel-footer {`,
    `  border-top: 1px solid #f1f5f9;`,
    `  padding: 10px 16px;`,
    `}`,
    `.notif-email-btn {`,
    `  width: 100%;`,
    `  background: #6366f1;`,
    `  color: #fff;`,
    `  border: none;`,
    `  border-radius: 8px;`,
    `  padding: 9px;`,
    `  font-size: 0.88rem;`,
    `  font-weight: 600;`,
    `  cursor: pointer;`,
    `  transition: background 0.2s;`,
    `}`,
    `.notif-email-btn:hover { background: #4f46e5; }`,
    ``,
    `/* Dark mode – notificações */`,
    `.app.dark-mode .notif-panel {`,
    `  background: var(--dm-bg1);`,
    `  box-shadow: 0 12px 40px rgba(0,0,0,0.45);`,
    `}`,
    `.app.dark-mode .notif-panel-header { border-color: var(--dm-border); color: var(--dm-text1); }`,
    `.app.dark-mode .notif-close-btn { color: var(--dm-text2); }`,
    `.app.dark-mode .notif-close-btn:hover { background: var(--dm-bg3); }`,
    `.app.dark-mode .notif-mark-read { border-color: #4ade80; color: #4ade80; }`,
    `.app.dark-mode .notif-mark-read:hover { background: rgba(74,222,128,0.08); }`,
    `.app.dark-mode .notif-item { border-color: var(--dm-border); }`,
    `.app.dark-mode .notif-item:hover { background: var(--dm-bg3); }`,
    `.app.dark-mode .notif-item.unread { background: rgba(99,102,241,0.10); }`,
    `.app.dark-mode .notif-item.unread:hover { background: rgba(99,102,241,0.18); }`,
    `.app.dark-mode .notif-item-title { color: var(--dm-text1); }`,
    `.app.dark-mode .notif-item-body { color: var(--dm-text2); }`,
    `.app.dark-mode .notif-item-date { color: #64748b; }`,
    `.app.dark-mode .notif-panel-footer { border-color: var(--dm-border); }`,
    `.app.dark-mode .notif-bell-btn { background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.15); }`,
    `.app.dark-mode .notif-bell-btn:hover { background: rgba(255,255,255,0.15); }`,
    ``,
].join(R);

const anchor = '\r\n\r\n/* Bot';
const idx = c.lastIndexOf(anchor);
if (idx === -1) { console.error('anchor not found'); process.exit(1); }
c = c.substring(0, idx + 2) + notifCSS + R + c.substring(idx + 2);
console.log('CSS inserted at:', idx, 'new length:', c.length);
fs.writeFileSync('gestor-financeiro-frontend/src/App.css', c, 'utf8');
console.log('Done');
